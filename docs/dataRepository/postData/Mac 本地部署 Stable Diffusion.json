{"title": "Mac \u672c\u5730\u90e8\u7f72 Stable Diffusion", "date": "2023-11-14 18:35:47", "categories": "\u5de5\u5177", "tags": "Stable Diffusion", "keywords": "Stable Diffusion,Mac", "description": "", "images": "", "file_name": "Mac \u672c\u5730\u90e8\u7f72 Stable Diffusion", "short": " \u4f7f\u7528\u7684 Mac \u914d\u7f6e \n MacBook Pro (2022) \n\u82af\u7247: Apple M2 \n\u5185\u5b58: 16GB \n\u5b58\u50a8: 512GB \n\u7cfb\u7edf: Ventura 13.0 \n ", "content": "<h3 id=\"mac\">\u4f7f\u7528\u7684 Mac \u914d\u7f6e</h3>\n<p>MacBook Pro (2022)<br />\n\u82af\u7247: Apple M2<br />\n\u5185\u5b58: 16GB<br />\n\u5b58\u50a8: 512GB<br />\n\u7cfb\u7edf: Ventura 13.0</p>\n<!-- more -->\n\n<h3 id=\"_1\">\u73af\u5883\u8981\u6c42</h3>\n<h4 id=\"homebrew\">Homebrew</h4>\n<h5 id=\"_2\">\u5b98\u65b9\u5b89\u88c5 (\u9700\u8981\u68af\u5b50)</h5>\n<p>\u5b89\u88c5\u547d\u4ee4:</p>\n<div class=\"codehilite\"><pre><span></span><code>/bin/zsh<span class=\"w\"> </span>-c<span class=\"w\"> </span><span class=\"s2\">&quot;</span><span class=\"k\">$(</span>curl<span class=\"w\"> </span>-fsSL<span class=\"w\"> </span>https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class=\"k\">)</span><span class=\"s2\">&quot;</span>\n</code></pre></div>\n\n<p>\u5378\u8f7d\u547d\u4ee4:</p>\n<div class=\"codehilite\"><pre><span></span><code>/bin/zsh<span class=\"w\"> </span>-c<span class=\"w\"> </span><span class=\"s2\">&quot;</span><span class=\"k\">$(</span>curl<span class=\"w\"> </span>-fsSL<span class=\"w\"> </span>https://raw.githubusercontent.com/Homebrew/install/master/uninstall.sh<span class=\"k\">)</span><span class=\"s2\">&quot;</span>\n</code></pre></div>\n\n<h5 id=\"_3\">\u56fd\u5185\u7ef4\u62a4\u955c\u50cf</h5>\n<p>\u5b89\u88c5\u547d\u4ee4:</p>\n<div class=\"codehilite\"><pre><span></span><code>/bin/zsh<span class=\"w\"> </span>-c<span class=\"w\"> </span><span class=\"s2\">&quot;</span><span class=\"k\">$(</span>curl<span class=\"w\"> </span>-fsSL<span class=\"w\"> </span>https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh<span class=\"k\">)</span><span class=\"s2\">&quot;</span>\n</code></pre></div>\n\n<p>\u5378\u8f7d\u547d\u4ee4:</p>\n<div class=\"codehilite\"><pre><span></span><code>/bin/zsh<span class=\"w\"> </span>-c<span class=\"w\"> </span><span class=\"s2\">&quot;</span><span class=\"k\">$(</span>curl<span class=\"w\"> </span>-fsSL<span class=\"w\"> </span>https://gitee.com/cunkai/HomebrewCN/raw/master/HomebrewUninstall.sh<span class=\"k\">)</span><span class=\"s2\">&quot;</span>\n</code></pre></div>\n\n<h5 id=\"homebrew_1\">Homebrew \u57fa\u7840\u6307\u4ee4</h5>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># \u67e5\u770b\u7248\u672c</span>\nbrew<span class=\"w\"> </span>-v\n\n<span class=\"c1\"># \u5b89\u88c5</span>\nbrew<span class=\"w\"> </span>install<span class=\"w\"> </span>xxx\n</code></pre></div>\n\n<h4 id=\"python\">Python</h4>\n<p>\u67e5\u770b Python \u662f\u5426\u5b89\u88c5</p>\n<div class=\"codehilite\"><pre><span></span><code>python3<span class=\"w\"> </span>-V\n\n\u8f93\u51fa:<span class=\"w\"> </span>Python<span class=\"w\"> </span><span class=\"m\">3</span>.10.10\n</code></pre></div>\n\n<p>\u5982\u679c\u6ca1\u6709\u8f93\u51fa\u7248\u672c\u53f7, \u524d\u5f80 <a href=\"https://www.python.org/downloads/macos/\">Python \u5b98\u7f51</a> \u4e0b\u8f7d, \u6559\u7a0b\u4f7f\u7528\u7684 Python 3.10.10, \u5177\u4f53\u4ee5 <a href=\"https://github.com/AUTOMATIC1111/stable-diffusion-webui\">stable-diffusion-webui</a> \u8981\u6c42.</p>\n<p>\u5b89\u88c5\u540e, \u9700\u8981\u914d\u7f6e\u73af\u5883\u53d8\u91cf.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\"># 1.\u7f16\u8f91 ~/.zprofile</span>\nvim<span class=\"w\"> </span>~/.zprofile\n\n<span class=\"c1\"># 2.\u5728 zprofile \u52a0\u5165\u4ee5\u4e0b\u5185\u5bb9:</span>\n<span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"s2\">&quot;/Library/Frameworks/Python.framework/Versions/3.10/bin:</span><span class=\"si\">${</span><span class=\"nv\">PATH</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span>\n<span class=\"nb\">export</span><span class=\"w\"> </span>PATH\n<span class=\"nb\">alias</span><span class=\"w\"> </span><span class=\"nv\">python</span><span class=\"o\">=</span><span class=\"s2\">&quot;/Library/Frameworks/Python.framework/Versions/3.10/bin/python3&quot;</span>\n\n<span class=\"c1\"># 3.\u4f7f\u914d\u7f6e\u751f\u6548</span>\n<span class=\"nb\">source</span><span class=\"w\"> </span>~/.zprofile\n</code></pre></div>\n\n<h3 id=\"stable-diffusion\">\u4e0b\u8f7d Stable Diffusion</h3>\n<p>\u4f7f\u7528 git clone Stable Diffusino WebUI \u4ed3\u5e93</p>\n<div class=\"codehilite\"><pre><span></span><code>git<span class=\"w\"> </span>clone<span class=\"w\"> </span>https://github.com/AUTOMATIC1111/stable-diffusion-webui\n</code></pre></div>\n\n<h3 id=\"_4\">\u4e0b\u8f7d\u6a21\u578b</h3>\n<h4 id=\"_5\">\u6a21\u578b\u7c7b\u578b</h4>\n<p>\u6a21\u578b\u4e3b\u8981\u5206\u4e3a\u4e09\u5927\u7c7b: \u5927\u6a21\u578b(checkpoint)\u3001Lora\u3001VAE, \u4e0d\u540c\u7c7b\u578b\u7684\u6a21\u578b\u653e\u7f6e\u8def\u5f84\u4e0d\u4e00\u6837.</p>\n<h5 id=\"checkpoint\">\u5927\u6a21\u578b(checkpoint)</h5>\n<p>\u6a21\u578b\u6587\u4ef6\u540e\u7f00\u4e3a: ckpt \u6216\u8005 safetensors, \u9700\u653e\u7f6e\u5728 /stable-diffusion-webui/models/Stable-diffusion \u76ee\u5f55\u4e0b.</p>\n<h5 id=\"lora\">Lora \u6a21\u578b</h5>\n<p>\u9700\u653e\u7f6e\u5728 /stable-diffusion-webui/models/Lora \u76ee\u5f55\u4e0b, Lora \u6587\u4ef6\u5939\u9700\u8981\u6267\u884c ./webui.sh \u751f\u6210.</p>\n<h5 id=\"vae\">VAE \u6a21\u578b</h5>\n<p>\u9700\u653e\u7f6e\u5728 /stable-diffusion-webui/models/VAE \u76ee\u5f55\u4e0b</p>\n<h4 id=\"_6\">\u6a21\u578b\u83b7\u53d6</h4>\n<p>\u9700\u5728\u542f\u52a8 WebUI \u524d\u4e0b\u8f7d\u597d\u4e00\u4e2a\u5927\u6a21\u578b\u653e\u7f6e\u76ee\u5f55\u4e0b, \u5426\u5219\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u9ed8\u8ba4\u6a21\u578b, \u6bd4\u8f83\u8017\u8d39\u65f6\u95f4.</p>\n<h5 id=\"c\"><a href=\"https://civitai.com/\">C\u7ad9</a></h5>\n<p><img alt=\"image\" src=\"https://meanmouse.github.io/pic/postImage/Mac-\u672c\u5730\u90e8\u7f72-StableDiffusion/C\u7ad9\u6a21\u578b\u83b7\u53d6.png\" /></p>\n<h5 id=\"hugging-face\"><a href=\"https://huggingface.co/models?pipeline_tag=text-to-image&amp;sort=downloads\">Hugging Face</a></h5>\n<p><img alt=\"image\" src=\"https://meanmouse.github.io/pic/postImage/Mac-\u672c\u5730\u90e8\u7f72-StableDiffusion/HuggingFace1.png\" /><br />\n<img alt=\"image\" src=\"https://meanmouse.github.io/pic/postImage/Mac-\u672c\u5730\u90e8\u7f72-StableDiffusion/HuggingFace1.png\" /></p>\n<h5 id=\"liblibai\"><a href=\"https://www.liblib.ai/modelinfo/8b4b7eb6aa2c480bbe65ca3d4625632d\">LiblibAI</a></h5>\n<p><img alt=\"image\" src=\"https://meanmouse.github.io/pic/postImage/Mac-\u672c\u5730\u90e8\u7f72-StableDiffusion/LiblibAI.png\" /></p>\n<h3 id=\"webui\">\u542f\u52a8 WebUI</h3>\n<h4 id=\"_7\">\u51c6\u5907\u4f9d\u8d56\u5de5\u5177</h4>\n<div class=\"codehilite\"><pre><span></span><code>brew<span class=\"w\"> </span>install<span class=\"w\"> </span>cmake<span class=\"w\"> </span>protobuf<span class=\"w\"> </span>rust<span class=\"w\"> </span>wget\n</code></pre></div>\n\n<h4 id=\"webuish\">\u6267\u884c webui.sh</h4>\n<p>\u8fdb\u5165\u4ece git \u62c9\u53d6\u4e0b\u6765\u7684 stable-diffusion-webui \u76ee\u5f55, \u6267\u884c\u4e0b\u9762\u547d\u4ee4.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\"> </span><span class=\"nb\">cd</span><span class=\"w\"> </span>stable-diffusion-webui\n\n./webui.sh\n</code></pre></div>\n\n<p><img alt=\"image\" src=\"https://meanmouse.github.io/pic/postImage/Mac-\u672c\u5730\u90e8\u7f72-StableDiffusion/\u5e94\u7528\u754c\u9762.png\" /></p>\n<h3 id=\"_8\">\u6c49\u5316</h3>\n<p>\u53ef\u4f7f\u7528 <a href=\"https://github.com/VinsonLaro/stable-diffusion-webui-chinese\">stable-diffusion-webui-chinese</a> \u6269\u5c55\u8fdb\u884c\u6c49\u5316, \u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u8bf7\u9605\u8bfb<a href=\"https://github.com/VinsonLaro/stable-diffusion-webui-chinese#%E6%96%B9%E6%B3%951%E9%80%9A%E8%BF%87webui%E6%8B%93%E5%B1%95%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85\">\u5b89\u88c5\u8bf4\u660e</a></p>\n<h4 id=\"_9\">\u9047\u5230\u7684\u95ee\u9898</h4>\n<h5 id=\"1-failed-building-wheel-for-basicsr\">1. <a href=\"https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/13113\">Failed building wheel for basicsr</a></h5>\n<p>\u5728 stable-diffusion-webui/modules/launch_utils.py \u6587\u4ef6\u7b2c138\u884c\u4e2d\u7684 python \u547d\u4ee4\u4e2d\u63d2\u5165 --use-pep517</p>\n<div class=\"codehilite\"><pre><span></span><code>return run(f&#39;&quot;{python}&quot; -m pip {command} --use-pep517 --prefer-binary{index_url_line}&#39;, desc=f&quot;Installing {desc}&quot;, errdesc=f&quot;Couldn&#39;t install {desc}&quot;, live=live)\n</code></pre></div>\n\n<p><a href=\"https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/13113\">github issues</a></p>\n<h5 id=\"2-stable-diffusion-webui-extensions-ssl\">2. [stable-diffusion-webui-extensions \u52a0\u8f7d SSL \u9519\u8bef]</h5>\n<p>\u5728 launch_utils.py \u4e2d\u7684 from module.paths_internal import script_path, extensions_dir \u540e\u9762\u6dfb\u52a0:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"nn\">ssl</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">_create_default_https_context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">_create_unverified_context</span>\n</code></pre></div>\n\n<p><a href=\"https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/9285\">github issues</a></p>"}