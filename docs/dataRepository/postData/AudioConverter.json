{"title": "AudioConverter", "date": "2024-03-14 18:51:30", "categories": "\u97f3\u89c6\u9891", "tags": "Audio", "keywords": "AudioConverter,\u97f3\u9891\u89e3\u7801", "description": "", "images": "", "file_name": "AudioConverter", "short": " \u6982\u8ff0 \n AudioConverter \u53ef\u4ee5\u5c06\u5404\u79cd\u7ebf\u6027 PCM \u97f3\u9891\u683c\u5f0f\u4e4b\u95f4\u8fdb\u884c\u8f6c\u6362, \u9664\u6b64\u4e4b\u5916, \u5b83\u8fd8\u80fd\u5c06 PCM \u97f3\u9891\u683c\u5f0f\u8f6c\u4e3a\u538b\u7f29\u97f3\u9891\u683c\u5f0f, \u4e5f\u80fd\u5c06\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u8f6c\u4e3a PCM \u97f3\u9891\u683c\u5f0f, \u8fbe\u5230\u89e3\u7801\u7684\u6548\u679c, \u5982\u679c\u8981\u5b9e\u73b0\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u4e4b\u95f4\u7684\u8f6c\u6362, \u5219\u53ef\u4ee5\u5148\u8f6c PCM \u97f3\u9891\u683c\u5f0f, \u518d\u8f6c\u76ee\u6807\u538b\u7f29\u97f3\u9891\u683c\u5f0f, \u652f\u6301\u7684\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u6709: \n \n MP3 \n WAV \n AAC \n FLAC \n OGG \n WMA \n AIFF \n M4A \n ALAC \n AC3 \n \n ", "content": "<h3 id=\"_1\">\u6982\u8ff0</h3>\n<p>AudioConverter \u53ef\u4ee5\u5c06\u5404\u79cd\u7ebf\u6027 PCM \u97f3\u9891\u683c\u5f0f\u4e4b\u95f4\u8fdb\u884c\u8f6c\u6362, \u9664\u6b64\u4e4b\u5916, \u5b83\u8fd8\u80fd\u5c06 PCM \u97f3\u9891\u683c\u5f0f\u8f6c\u4e3a\u538b\u7f29\u97f3\u9891\u683c\u5f0f, \u4e5f\u80fd\u5c06\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u8f6c\u4e3a PCM \u97f3\u9891\u683c\u5f0f, \u8fbe\u5230\u89e3\u7801\u7684\u6548\u679c, \u5982\u679c\u8981\u5b9e\u73b0\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u4e4b\u95f4\u7684\u8f6c\u6362, \u5219\u53ef\u4ee5\u5148\u8f6c PCM \u97f3\u9891\u683c\u5f0f, \u518d\u8f6c\u76ee\u6807\u538b\u7f29\u97f3\u9891\u683c\u5f0f, \u652f\u6301\u7684\u538b\u7f29\u97f3\u9891\u683c\u5f0f\u6709:</p>\n<ul>\n<li>MP3</li>\n<li>WAV</li>\n<li>AAC</li>\n<li>FLAC</li>\n<li>OGG</li>\n<li>WMA</li>\n<li>AIFF</li>\n<li>M4A</li>\n<li>ALAC</li>\n<li>AC3</li>\n</ul>\n<!-- more -->\n\n<h3 id=\"audiostreambasicdescription\">AudioStreamBasicDescription</h3>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"bp\">AudioStreamBasicDescription</span>\n<span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">Float64</span><span class=\"w\">             </span><span class=\"n\">mSampleRate</span><span class=\"p\">;</span><span class=\"w\">  </span><span class=\"n\">\u97f3\u9891\u6d41\u7684\u91c7\u6837\u7387</span><span class=\"err\">\uff08</span><span class=\"n\">\u6bcf\u79d2\u91c7\u6837\u6b21\u6570</span><span class=\"err\">\uff09</span><span class=\"mf\">44100.0</span>\n<span class=\"w\">    </span><span class=\"n\">AudioFormatID</span><span class=\"w\">       </span><span class=\"n\">mFormatID</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u97f3\u9891\u6570\u636e\u7684\u683c\u5f0f\u6807\u8bc6\u7b26</span><span class=\"err\">\uff0c</span><span class=\"n\">\u4f8b\u5982</span><span class=\"w\"> </span><span class=\"n\">kAudioFormatLinearPCM</span><span class=\"w\"> </span><span class=\"n\">\u8868\u793a\u7ebf\u6027</span><span class=\"w\"> </span><span class=\"n\">PCM</span><span class=\"w\"> </span><span class=\"n\">\u683c\u5f0f</span><span class=\"err\">\u3002</span>\n<span class=\"w\">    </span><span class=\"n\">AudioFormatFlags</span><span class=\"w\">    </span><span class=\"n\">mFormatFlags</span><span class=\"p\">;</span><span class=\"w\">  </span><span class=\"n\">\u97f3\u9891\u6570\u636e\u7684\u683c\u5f0f\u6807\u5fd7\u4f4d</span><span class=\"err\">\uff0c</span><span class=\"n\">\u7528\u4e8e\u6307\u5b9a\u7279\u5b9a\u7684\u683c\u5f0f\u9009\u9879\u548c\u7279\u6027</span><span class=\"err\">\u3002</span><span class=\"n\">kAudioFormatFlagIsSignedInteger</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">kAudioFormatFlagIsPacked</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mBytesPerPacket</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u6bcf\u4e2a\u6570\u636e\u5305\u4e2d\u7684\u5b57\u8282\u6570</span><span class=\"err\">\u3002</span><span class=\"w\">  </span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mFramesPerPacket</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u6bcf\u4e2a\u6570\u636e\u5305\u4e2d\u7684\u5e27\u6570</span><span class=\"err\">\u3002</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mBytesPerFrame</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u6bcf\u5e27\u7684\u5b57\u8282\u6570</span><span class=\"err\">\u3002</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mChannelsPerFrame</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u6bcf\u5e27\u7684\u58f0\u9053\u6570</span><span class=\"err\">\u3002</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mBitsPerChannel</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">\u6bcf\u4e2a\u58f0\u9053\u7684\u6bd4\u7279\u6570</span><span class=\"err\">\u3002</span><span class=\"w\"> </span><span class=\"mi\">16</span>\n<span class=\"w\">    </span><span class=\"kt\">UInt32</span><span class=\"w\">              </span><span class=\"n\">mReserved</span><span class=\"p\">;</span><span class=\"w\">  </span><span class=\"n\">\u4fdd\u7559\u5b57\u6bb5</span><span class=\"err\">\uff0c</span><span class=\"n\">\u672a\u4f7f\u7528</span><span class=\"err\">\u3002</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n\n<h4 id=\"kaudioformatflagisfloatkaudioformatflagissignedinteger\">kAudioFormatFlagIsFloat\u3001kAudioFormatFlagIsSignedInteger</h4>\n<ul>\n<li>kAudioFormatFlagIsFloat: \u6d6e\u70b9\u578b\u91c7\u6837\u6570\u636e, \u6709: Float 16, Float 32.</li>\n<li>kAudioFormatFlagIsSignedInteger: \u6709\u7b26\u53f7\u6574\u6570\u91c7\u6837\u6570\u636e. \u6709: Int16, Int32.</li>\n</ul>\n<p>\u5728 iOS \u8bbe\u5907\u4e0a\uff0c16 \u4f4d\u6d6e\u70b9\u578b PCM \u683c\u5f0f\u662f\u4e0d\u88ab\u76f4\u63a5\u652f\u6301\u7684\u3002iOS \u7684 Core Audio <br />\n\u6846\u67b6\u4e2d\u5e76\u6ca1\u6709\u63d0\u4f9b\u539f\u751f\u7684\u652f\u6301\u6765\u5904\u7406\u548c\u64ad\u653e 16 \u4f4d\u6d6e\u70b9\u578b PCM \u97f3\u9891\u6570\u636e\u3002<br />\niOS \u8bbe\u5907\u7684\u97f3\u9891\u5f15\u64ce\u901a\u5e38\u4f7f\u7528\u6574\u6570\u8868\u793a\u7684 PCM \u683c\u5f0f\uff0c\u5982 16 \u4f4d\u6709\u7b26\u53f7\u6574\u6570\uff08SInt16\uff09\u6216 32 \u4f4d\u6d6e\u70b9\u578b\uff08Float32\uff09\u3002</p>\n<h4 id=\"kaudioformatflagisnoninterleaved\">kAudioFormatFlagIsNonInterleaved</h4>\n<p><strong>kAudioFormatFlagIsNonInterleaved</strong> \u662f\u4e00\u4e2a\u7528\u4e8e\u63cf\u8ff0\u97f3\u9891\u6570\u636e\u683c\u5f0f\u7684\u6807\u5fd7\uff0c\u901a\u5e38\u5728Core Audio\u6846\u67b6\u4e2d\u4f7f\u7528\u3002\u5f53\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u6807\u5fd7\u65f6\uff0c\u8868\u793a\u97f3\u9891\u6570\u636e\u4ee5\u975e\u4ea4\u9519\uff08non-interleaved\uff09\u7684\u65b9\u5f0f\u5b58\u50a8\u3002</p>\n<p>\u5728\u975e\u4ea4\u9519\u97f3\u9891\u6570\u636e\u4e2d\uff0c\u6bcf\u4e2a\u58f0\u9053\u7684\u6837\u672c\u503c\u88ab\u5355\u72ec\u5b58\u50a8\u5728\u5404\u81ea\u7684\u7f13\u51b2\u533a\u4e2d\uff0c\u800c\u4e0d\u662f\u4ea4\u9519\u5b58\u50a8\u5728\u540c\u4e00\u4e2a\u7f13\u51b2\u533a\u4e2d\u3002\u8fd9\u79cd\u8868\u793a\u65b9\u5f0f\u5728\u5904\u7406\u591a\u901a\u9053\u97f3\u9891\u6570\u636e\u65f6\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u5bf9\u6bcf\u4e2a\u58f0\u9053\u8fdb\u884c\u72ec\u7acb\u5904\u7406\u3002</p>\n<p>\u5177\u4f53\u4f53\u73b0\u5728 <strong>AudioBufferList</strong> \u5bf9 mBuffers \u6570\u91cf\u7684\u5206\u914d\u4e0a, <strong>kAudioFormatFlagIsNonInterleaved</strong> \u65f6\u5b58\u5728\u591a\u4e2a\u7f13\u51b2\u533a, mBuffers \u6570\u91cf\u53d6\u51b3\u4e8e <strong>AudioStreamBasicDescription</strong> \u7684 mChannelsPerFrame. \u800c\u4ea4\u9519\u5b58\u50a8\u53ea\u6709\u4e00\u4e2a\u7f13\u51b2\u533a, mBuffers \u6570\u91cf\u4e3a 1.</p>\n<h4 id=\"_2\"></h4>\n<h3 id=\"audioconverter\">AudioConverter \u521d\u59cb\u5316</h3>\n<h4 id=\"audioconverterref\">\u521b\u5efa AudioConverterRef \u5b9e\u4f8b</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterNew</span><span class=\"p\">(</span><span class=\"w\">      </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"bp\">AudioStreamBasicDescription</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">inSourceFormat</span><span class=\"p\">,</span>\n<span class=\"w\">                        </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"bp\">AudioStreamBasicDescription</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">inDestinationFormat</span><span class=\"p\">,</span>\n<span class=\"w\">                        </span><span class=\"n\">AudioConverterRef</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nonnull</span><span class=\"w\"> </span><span class=\"n\">outAudioConverter</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<ul>\n<li>inSourceFormat: \u8f93\u5165\u97f3\u9891\u683c\u5f0f.</li>\n<li>inDestinationFormat: \u9700\u8981\u8f6c\u6362\u7684\u76ee\u6807\u683c\u5f0f.</li>\n<li>outAudioConverter: \u521b\u5efa\u597d\u7684 AudioConverter \u5b9e\u4f8b.</li>\n</ul>\n<h4 id=\"audioconverter_1\">AudioConverter \u5c5e\u6027\u8bbe\u7f6e\u548c\u8bfb\u53d6</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterSetProperty</span><span class=\"p\">(</span><span class=\"w\">  </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">           </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"n\">AudioConverterPropertyID</span><span class=\"w\">    </span><span class=\"n\">inPropertyID</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"kt\">UInt32</span><span class=\"w\">                      </span><span class=\"n\">inPropertyDataSize</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                </span><span class=\"n\">inPropertyData</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b</li>\n<li>inPropertyID: \u8981\u8bbe\u7f6e\u7684\u5c5e\u6027.</li>\n<li>inPropertyDataSize: \u8bbe\u7f6e\u503c\u7684\u5b57\u8282\u5927\u5c0f.</li>\n<li>inPropertyData: \u8bbe\u7f6e\u503c\u6570\u636e.</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterGetProperty</span><span class=\"p\">(</span><span class=\"w\">  </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">           </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"n\">AudioConverterPropertyID</span><span class=\"w\">    </span><span class=\"n\">inPropertyID</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                    </span><span class=\"n\">ioPropertyDataSize</span><span class=\"p\">,</span>\n<span class=\"w\">                            </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                      </span><span class=\"n\">outPropertyData</span><span class=\"p\">);</span><span class=\"w\"> </span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b.</li>\n<li>inPropertyID: \u8981\u8bfb\u53d6\u7684\u5c5e\u6027.</li>\n<li>ioPropertyDataSize: \u5c5e\u6027\u503c\u7684\u5b57\u8282\u5927\u5c0f.</li>\n<li>outPropertyData: \u8bfb\u53d6\u5230\u7684\u5c5e\u6027\u503c.</li>\n</ul>\n<h4 id=\"audioconverterpropertyid\">AudioConverterPropertyID</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">CF_ENUM</span><span class=\"p\">(</span><span class=\"n\">AudioConverterPropertyID</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyMinimumInputBufferSize</span><span class=\"w\">       </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">mibs</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyMinimumOutputBufferSize</span><span class=\"w\">      </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">mobs</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyMaximumInputPacketSize</span><span class=\"w\">       </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">xips</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"c1\">// \u7528\u4e8e\u6307\u5b9a\u97f3\u9891\u8f6c\u6362\u5668\u53ef\u4ee5\u751f\u6210\u7684\u6700\u5927\u8f93\u51fa\u6570\u636e\u5305\u5927\u5c0f\u3002\u8fd9\u4e2a\u5c5e\u6027\u901a\u5e38\u7528\u4e8e\u914d\u7f6e\u97f3\u9891\u8f6c\u6362\u5668\u7684\u884c\u4e3a\uff0c\u4ee5\u786e\u4fdd\u8f93\u51fa\u6570\u636e\u5305\u7684\u5927\u5c0f\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c\u4ece\u800c\u6ee1\u8db3\u7279\u5b9a\u7684\u9700\u6c42\u6216\u9650\u5236\u3002</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyMaximumOutputPacketSize</span><span class=\"w\">      </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">xops</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyCalculateInputBufferSize</span><span class=\"w\">     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">cibs</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyCalculateOutputBufferSize</span><span class=\"w\">    </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">cobs</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyInputCodecParameters</span><span class=\"w\">         </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">icdp</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyOutputCodecParameters</span><span class=\"w\">        </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">ocdp</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterSampleRateConverterComplexity</span><span class=\"w\">        </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">srca</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterSampleRateConverterQuality</span><span class=\"w\">           </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">srcq</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterSampleRateConverterInitialPhase</span><span class=\"w\">      </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">srcp</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterCodecQuality</span><span class=\"w\">                         </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">cdqu</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPrimeMethod</span><span class=\"w\">                          </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">prmm</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPrimeInfo</span><span class=\"w\">                            </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">prim</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterChannelMap</span><span class=\"w\">                           </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">chmp</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterDecompressionMagicCookie</span><span class=\"w\">             </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">dmgc</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterCompressionMagicCookie</span><span class=\"w\">               </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">cmgc</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterEncodeBitRate</span><span class=\"w\">                        </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">brat</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterEncodeAdjustableSampleRate</span><span class=\"w\">           </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">ajsr</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterInputChannelLayout</span><span class=\"w\">                   </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">icl</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterOutputChannelLayout</span><span class=\"w\">                  </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">ocl</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterApplicableEncodeBitRates</span><span class=\"w\">             </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">aebr</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterAvailableEncodeBitRates</span><span class=\"w\">              </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">vebr</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterApplicableEncodeSampleRates</span><span class=\"w\">          </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">aesr</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterAvailableEncodeSampleRates</span><span class=\"w\">           </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">vesr</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterAvailableEncodeChannelLayoutTags</span><span class=\"w\">     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">aecl</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterCurrentOutputStreamDescription</span><span class=\"w\">       </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">acod</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterCurrentInputStreamDescription</span><span class=\"w\">        </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">acid</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertySettings</span><span class=\"w\">                     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">acps</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyBitDepthHint</span><span class=\"w\">                 </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">acbd</span><span class=\"err\">&#39;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">kAudioConverterPropertyFormatList</span><span class=\"w\">                   </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"err\">&#39;</span><span class=\"n\">flst</span><span class=\"err\">&#39;</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n\n<h5 id=\"kaudioconverterdecompressionmagiccookie\">kAudioConverterDecompressionMagicCookie (\u89e3\u7801\u5fc5\u8981\u914d\u7f6e)</h5>\n<blockquote>\n<p>In the realm of Core Audio, a magic cookie is an opaque set of metadata attached to a compressed sound file or stream. The metadata gives a decoder the details it needs to properly decompress the file or stream. You treat a magic cookie as a black box, relying on Core Audio functions to copy, read, and use the contained metadata.<br />\n\u5728 Core Audio \u9886\u57df\uff0cmagic cookie \u662f\u9644\u52a0\u5230\u538b\u7f29\u58f0\u97f3\u6587\u4ef6\u6216\u6d41\u7684\u4e00\u7ec4\u4e0d\u900f\u660e\u5143\u6570\u636e\u3002\u5143\u6570\u636e\u4e3a\u89e3\u7801\u5668\u63d0\u4f9b\u6b63\u786e\u89e3\u538b\u7f29\u6587\u4ef6\u6216\u6d41\u6240\u9700\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u60a8\u5c06 magic cookie \u89c6\u4e3a\u9ed1\u5323\u5b50\uff0c\u4f9d\u9760 Core Audio \u529f\u80fd\u6765\u590d\u5236\u3001\u8bfb\u53d6\u548c\u4f7f\u7528\u6240\u5305\u542b\u7684\u5143\u6570\u636e\u3002<br />\n\u5f15\u7528 <a href=\"https://developer.apple.com/library/archive/documentation/MusicAudio/Conceptual/CoreAudioOverview/CoreAudioEssentials/CoreAudioEssentials.html#//apple_ref/doc/uid/TP40003577-CH10-SW17\">Apple Document</a></p>\n</blockquote>\n<p>\u90e8\u5206\u97f3\u9891\u6587\u4ef6\u5b58\u5728 magic cookies \u4fe1\u606f, \u8fd9\u4e2a\u4fe1\u606f\u5728\u89e3\u7801\u65f6\u9700\u8981\u7528\u5230, \u6240\u4ee5\u5982\u679c\u97f3\u9891\u5b58\u5728 magic cookies, \u5c31\u8981\u8bbe\u7f6e <strong>kAudioConverterDecompressionMagicCookie</strong> \u5c5e\u6027. \u6ca1\u6709\u5f97\u8bdd, \u5c31\u4e0d\u7528\u5904\u7406.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">NSData</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">cookieData</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">...;</span>\n<span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cookieData</span><span class=\"p\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">OSStatus</span><span class=\"w\"> </span><span class=\"n\">status</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">AudioConverterSetProperty</span><span class=\"p\">(</span><span class=\"n\">_audioConverter</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">kAudioConverterDecompressionMagicCookie</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">UInt32</span><span class=\"p\">)</span><span class=\"n\">cookieData</span><span class=\"p\">.</span><span class=\"n\">length</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">cookieData</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"p\">]);</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">status</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">noErr</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"c1\">/// \u9500\u6bc1 AudioConverterRef</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<h5 id=\"kaudioconvertercurrentinputstreamdescription\">kAudioConverterCurrentInputStreamDescription</h5>\n<p>AudioConverterRef \u7684\u8f93\u5165\u6e90\u97f3\u9891\u683c\u5f0f, \u867d\u8bf4\u5728\u521b\u5efa\u65f6\u4f20\u5165\u4e86\u97f3\u9891\u683c\u5f0f, \u4f46\u4e0d\u80fd\u4fdd\u8bc1\u8bbe\u7f6e\u6210\u529f, \u6240\u4ee5\u9700\u8981\u518d\u83b7\u53d6\u4e00\u4e0b\u786e\u8ba4.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">AudioStreamBasicDescription</span><span class=\"w\"> </span><span class=\"n\">inputFormat</span><span class=\"p\">;</span>\n<span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">inputFormat</span><span class=\"p\">);</span>\n<span class=\"n\">AudioConverterGetProperty</span><span class=\"p\">(</span><span class=\"n\">_audioConverter</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">kAudioConverterCurrentInputStreamDescription</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">size</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">inputFormat</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<h5 id=\"kaudioconvertercurrentoutputstreamdescription\">kAudioConverterCurrentOutputStreamDescription</h5>\n<p>AudioConverterRef \u7684\u8f93\u51fa\u6e90\u97f3\u9891\u683c\u5f0f, \u867d\u8bf4\u5728\u521b\u5efa\u65f6\u4f20\u5165\u4e86\u97f3\u9891\u683c\u5f0f, \u4f46\u4e0d\u80fd\u4fdd\u8bc1\u8bbe\u7f6e\u6210\u529f, \u6240\u4ee5\u9700\u8981\u518d\u83b7\u53d6\u4e00\u4e0b\u786e\u8ba4.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">AudioStreamBasicDescription</span><span class=\"w\"> </span><span class=\"n\">outputFormat</span><span class=\"p\">;</span>\n<span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"n\">size</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">sizeof</span><span class=\"p\">(</span><span class=\"n\">outputFormat</span><span class=\"p\">);</span>\n<span class=\"n\">AudioConverterGetProperty</span><span class=\"p\">(</span><span class=\"n\">_audioConverter</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">kAudioConverterCurrentOutputStreamDescription</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">size</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">outputFormat</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<h3 id=\"_3\">\u8f6c\u6362\u683c\u5f0f</h3>\n<h4 id=\"audioconverterconvertbuffer\">AudioConverterConvertBuffer</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterConvertBuffer</span><span class=\"p\">(</span><span class=\"w\">    </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">               </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                                </span><span class=\"kt\">UInt32</span><span class=\"w\">                          </span><span class=\"n\">inInputDataSize</span><span class=\"p\">,</span>\n<span class=\"w\">                                </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                    </span><span class=\"n\">inInputData</span><span class=\"p\">,</span>\n<span class=\"w\">                                </span><span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                        </span><span class=\"n\">ioOutputDataSize</span><span class=\"p\">,</span>\n<span class=\"w\">                                </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                          </span><span class=\"n\">outOutputData</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b.</li>\n<li>inInputDataSize: \u8f93\u5165\u6e90\u97f3\u9891\u5b57\u8282\u5927\u5c0f.</li>\n<li>inInputData: \u8f93\u5165\u6e90\u97f3\u9891\u6570\u636e.</li>\n<li>ioOutputDataSize: \u8f93\u51fa\u6e90\u97f3\u9891\u5b57\u8282\u5927\u5c0f.</li>\n<li>outOutputData: \u8f93\u51fa\u6e90\u97f3\u9891\u6570\u636e.</li>\n</ul>\n<p><strong>AudioConverterConvertBuffer</strong> \u7528\u4e8e\u7f13\u51b2\u533a\u5bf9\u7f13\u51b2\u533a\u7684\u97f3\u9891\u8f6c\u6362, \u8fd9\u4e2a\u8f6c\u6362\u53ea\u652f\u6301\u540c\u6837\u91c7\u6837\u7387\u7684 PCM -&gt; PCM, \u5982\u9700 PCM \u548c \u538b\u7f29\u683c\u5f0f\u7684\u8f6c\u6362\u8bf7\u4f7f\u7528 <strong>AudioConverterFillComplexBuffer</strong>.</p>\n<h4 id=\"audioconverterconvertcomplexbuffer\">AudioConverterConvertComplexBuffer</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"n\">AudioConverterConvertComplexBuffer</span><span class=\"p\">(</span><span class=\"w\"> </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">               </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"kt\">UInt32</span><span class=\"w\">                          </span><span class=\"n\">inNumberPCMFrames</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"bp\">AudioBufferList</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">         </span><span class=\"n\">inInputData</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"bp\">AudioBufferList</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">               </span><span class=\"n\">outOutputData</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b.</li>\n<li>inNumberPCMFrames: \u8f93\u5165 PCM \u6570\u636e\u5e27\u6570\u91cf.</li>\n<li>inInputData: \u8f93\u5165\u6e90\u97f3\u9891\u6570\u636e(<strong>AudioBufferList</strong>).</li>\n<li>outOutputData: \u8f93\u51fa\u6e90\u97f3\u9891\u6570\u636e(<strong>AudioBufferList</strong>)</li>\n</ul>\n<p><strong>AudioConverterConvertBuffer</strong> \u7528\u4e8e AudioBufferList \u5bf9 AudioBufferList \u7684\u97f3\u9891\u8f6c\u6362, \u8fd9\u4e2a\u8f6c\u6362\u53ea\u652f\u6301\u540c\u6837\u91c7\u6837\u7387\u7684 PCM -&gt; PCM, \u5982\u9700 PCM \u548c \u538b\u7f29\u683c\u5f0f\u7684\u8f6c\u6362\u8bf7\u4f7f\u7528 <strong>AudioConverterFillComplexBuffer</strong>.</p>\n<p>\u4e0e <strong>AudioConverterConvertBuffer</strong> \u76f8\u6bd4, \u5b83\u53ef\u4ee5\u5904\u7406\u66f4\u590d\u6742\u7684\u97f3\u9891\u8f6c\u6362, \u5b83\u5141\u8bb8\u5904\u7406\u591a\u4e2a\u8f93\u5165\u6570\u636e\u5305\u548c\u8f93\u51fa\u6570\u636e\u5305\uff0c\u6bcf\u4e2a\u6570\u636e\u5305\u53ef\u4ee5\u5177\u6709\u4e0d\u540c\u7684\u683c\u5f0f\u6216\u5927\u5c0f\u3002</p>\n<h4 id=\"audioconverterfillcomplexbuffer\">AudioConverterFillComplexBuffer</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterFillComplexBuffer</span><span class=\"p\">(</span><span class=\"w\">    </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">                   </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"n\">AudioConverterComplexInputDataProc</span><span class=\"w\">  </span><span class=\"n\">inInputDataProc</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\">                   </span><span class=\"n\">inInputDataProcUserData</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                            </span><span class=\"n\">ioOutputDataPacketSize</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"bp\">AudioBufferList</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                   </span><span class=\"n\">outOutputData</span><span class=\"p\">,</span>\n<span class=\"w\">                                    </span><span class=\"bp\">AudioStreamPacketDescription</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\"> </span><span class=\"n\">outPacketDescription</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b.</li>\n<li>inInputDataProc: <strong>AudioConverterComplexInputDataProc</strong> \u63d0\u4f9b\u8f93\u5165\u6e90\u97f3\u9891\u6570\u636e\u7684\u56de\u8c03\u51fd\u6570.</li>\n<li>inInputDataProcUserData: \u4e0a\u4e0b\u6587\u5bf9\u8c61, \u5c06\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u4f20\u5165.</li>\n<li>ioOutputDataPacketSize: \u8f6c\u6362\u5230\u76ee\u6807\u683c\u5f0f\u65f6, \u8f93\u51fa\u7684\u97f3\u9891\u6570\u636e\u5b57\u8282\u5927\u5c0f.</li>\n<li>outOutputData: \u8f6c\u6362\u5230\u76ee\u6807\u683c\u5f0f\u7684\u6570\u636e.</li>\n<li>outPacketDescription: \u8f93\u5165\u65f6\u63d0\u4f9b\u4e00\u4e2a\u5206\u914d\u597d\u7684 <strong>AudioStreamPacketDescription</strong> \u5185\u5b58\u5757, <strong>AudioConverterComplexInputDataProc</strong> \u56de\u8c03\u4e2d\u9700\u8981\u8fd4\u56de\u8f93\u5165\u6e90\u97f3\u9891\u5e27\u7684\u4fe1\u606f.</li>\n</ul>\n<h4 id=\"audioconvertercomplexinputdataproc\">AudioConverterComplexInputDataProc</h4>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">typedef</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">AudioConverterComplexInputDataProc</span><span class=\"p\">)(</span><span class=\"w\">  </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">               </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span>\n<span class=\"w\">                                        </span><span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">                        </span><span class=\"n\">ioNumberDataPackets</span><span class=\"p\">,</span>\n<span class=\"w\">                                        </span><span class=\"bp\">AudioBufferList</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\">               </span><span class=\"n\">ioData</span><span class=\"p\">,</span>\n<span class=\"w\">                                        </span><span class=\"bp\">AudioStreamPacketDescription</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\"> </span><span class=\"n\">outDataPacketDescription</span><span class=\"p\">,</span>\n<span class=\"w\">                                        </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"w\">               </span><span class=\"n\">inUserData</span><span class=\"p\">);</span>\n</code></pre></div>\n\n<ul>\n<li>inAudioConverter: AudioConverter \u5b9e\u4f8b.</li>\n<li>ioNumberDataPackets: \u53ef\u8f6c\u6362\u7684\u97f3\u9891\u5e27\u6570\u91cf.</li>\n<li>ioData: \u63d0\u4f9b\u8f93\u5165\u6e90\u97f3\u9891\u6570\u636e.</li>\n<li>outDataPacketDescription: \u4e0d\u4e3a NULL \u65f6, \u9700\u8981\u63d0\u4f9b\u8f93\u5165\u6e90\u97f3\u9891\u5e27\u4fe1\u606f.</li>\n<li>inUserData: \u4e0a\u4e0b\u6587\u5bf9\u8c61.</li>\n</ul>\n<p>\u793a\u4f8b:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">static</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span><span class=\"w\"> </span><span class=\"nf\">AudioConverter_input_data_proc</span><span class=\"p\">(</span><span class=\"n\">AudioConverterRef</span><span class=\"w\"> </span><span class=\"n\">inAudioConverter</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">UInt32</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">ioNumberDataPackets</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"bp\">AudioBufferList</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">ioData</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"bp\">AudioStreamPacketDescription</span><span class=\"w\"> </span><span class=\"o\">**</span><span class=\"n\">outDataPacketDescription</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">inUserData</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"c1\">/// \u586b\u5145\u6570\u636e\u5230\u8f93\u51fa ioData</span>\n<span class=\"w\">    </span><span class=\"c1\">/// srcBuffer \u97f3\u9891\u5e27\u6570\u636e</span>\n<span class=\"w\">    </span><span class=\"n\">ioData</span><span class=\"o\">-&gt;</span><span class=\"n\">mBuffers</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"n\">mData</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">__nullable</span><span class=\"p\">)[</span><span class=\"n\">srcBuffer</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"p\">];</span>\n<span class=\"w\">    </span><span class=\"n\">ioData</span><span class=\"o\">-&gt;</span><span class=\"n\">mBuffers</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"n\">mDataByteSize</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">UInt32</span><span class=\"p\">)</span><span class=\"n\">srcBuffer</span><span class=\"p\">.</span><span class=\"n\">length</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">ioData</span><span class=\"o\">-&gt;</span><span class=\"n\">mBuffers</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"n\">mNumberChannels</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">outDataPacketDescription</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"nb\">NULL</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"c1\">/// \u97f3\u9891\u5e27\u4fe1\u606f</span>\n<span class=\"w\">        </span><span class=\"o\">*</span><span class=\"n\">outDataPacketDescription</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">outputPktDescs</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n<span class=\"c1\">/// \u97f3\u9891\u5e27\u5206\u79bb\u4f7f\u7528: AudioFileStream</span>\n</code></pre></div>\n\n<h3 id=\"audioconverter_2\">\u9500\u6bc1 AudioConverter</h3>\n<p>AudioConverter \u4f7f\u7528\u5b8c\u540e\u9700\u53ca\u65f6\u9500\u6bc1.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">extern</span><span class=\"w\"> </span><span class=\"n\">OSStatus</span>\n<span class=\"nf\">AudioConverterDispose</span><span class=\"p\">(</span><span class=\"w\">  </span><span class=\"n\">AudioConverterRef</span><span class=\"w\">   </span><span class=\"n\">inAudioConverter</span><span class=\"p\">);</span>\n</code></pre></div>"}