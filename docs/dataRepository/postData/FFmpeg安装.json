{"title": "FFmpeg \u5b89\u88c5", "date": "2023-09-19 17:35:47", "categories": "\u5de5\u5177", "tags": "FFmpeg,rtmp,SRS,H.256\u63a8\u6d41", "keywords": "FFmpeg,rtmp,SRS,H.256", "description": "", "images": "", "file_name": "FFmpeg\u5b89\u88c5", "short": " FFmpeg \u5b89\u88c5 \n Homebrew \u65b9\u5f0f\u5b89\u88c5 \n 1\u3001\u6267\u884c\u5b89\u88c5\u547d\u4ee4 \n  brew install ffmpeg\nbrew install ffmpeg --HEAD # \u5b89\u88c5\u6700\u65b0\n  \n\n 2\u3001\u9009\u62e9\u7b2c\u4e09\u65b9\u4ed3\u5e93: homebrew-ffmpeg \u548c varenc-homebrew-ffmpeg  \n  brew tap homebrew-ffmpeg/ffmpeg # homebrew-ffmpeg \u4ed3\u5e93\n  \n\n ", "content": "<h1 id=\"ffmpeg\">FFmpeg \u5b89\u88c5</h1>\n<h2 id=\"homebrew\">Homebrew \u65b9\u5f0f\u5b89\u88c5</h2>\n<p>1\u3001\u6267\u884c\u5b89\u88c5\u547d\u4ee4</p>\n<pre class=\"codehilite\"><code>brew install ffmpeg\nbrew install ffmpeg --HEAD # \u5b89\u88c5\u6700\u65b0\n</code></pre>\n\n<p>2\u3001\u9009\u62e9\u7b2c\u4e09\u65b9\u4ed3\u5e93: homebrew-ffmpeg \u548c varenc-homebrew-ffmpeg </p>\n<pre class=\"codehilite\"><code>brew tap homebrew-ffmpeg/ffmpeg # homebrew-ffmpeg \u4ed3\u5e93\n</code></pre>\n\n<!-- more -->\n<p>3\u3001\u6839\u636e\u7b2c\u4e09\u65b9\u4ed3\u5e93\u5b89\u88c5</p>\n<pre class=\"codehilite\"><code>brew install homebrew-ffmpeg/ffmpeg/ffmpeg\n</code></pre>\n\n<p>4\u3001\u5173\u8054 options</p>\n<pre class=\"codehilite\"><code># \u83b7\u53d6\u652f\u6301\u7684options\nbrew options homebrew-ffmpeg/ffmpeg/ffmpeg\n\n# \u5173\u8054options\nbrew install homebrew-ffmpeg/ffmpeg/ffmpeg --with-aribb24 --with-chromaprint --with-decklink --with-fdk-aac --with-game-music-emu --with-jack --with-jpeg-xl --with-libaribb24 --with-libbluray --with-libbs2b --with-libcaca --with-libflite --with-libgsm --with-libmodplug --with-libopenmpt --with-librist --with-librsvg --with-libsoxr --with-libssh --with-libvidstab --with-libvmaf --with-libxml2 --with-libzvbi --with-opencore-amr --with-openh264 --with-openjpeg --with-openssl --with-openssl@1.1 --with-rav1e --with-rtmpdump --with-rubberband --with-speex --with-srt --with-svt-av1 --with-tesseract --with-two-lame --with-webp --with-xvid --with-zeromq --with-zimg\n</code></pre>\n\n<h2 id=\"ffmpeg-rtmp-h265\">FFmpeg \u652f\u6301 RTMP H265</h2>\n<h3 id=\"libx264\">\u5b89\u88c5 libx264</h3>\n<pre class=\"codehilite\"><code>git clone https://code.videolan.org/videolan/x264.git\ncd x264\nmkdir build\n./configure --prefix=$(pwd)/build --disable-asm --disable-cli --disable-shared --enable-static\nmake -j10\nmake install\n</code></pre>\n\n<h3 id=\"libx265\">\u5b89\u88c5 libx265</h3>\n<pre class=\"codehilite\"><code>git clone https://bitbucket.org/multicoreware/x265_git.git\ncd x265_git/build/linux\nmkdir build\ncmake -DCMAKE_INSTALL_PREFIX=$(pwd)/build -DENABLE_SHARED=OFF ../../source\nmake -j10\nmake install\n</code></pre>\n\n<h3 id=\"libx264libx265\">\u8bbe\u7f6e libx264\u3001libx265 \u73af\u5883\u53d8\u91cf</h3>\n<pre class=\"codehilite\"><code>export PKG_CONFIG_PATH=~/x264/build/lib/pkgconfig:~/x265_git/build/linux/build/lib/pkgconfig\n</code></pre>\n\n<h3 id=\"ffmpeg-rtmpflv-h265\">ffmpeg \u4e2d rtmp/flv \u6a21\u5757\u652f\u6301 h.265</h3>\n<pre class=\"codehilite\"><code>git clone -b 5.1 https://github.com/runner365/ffmpeg_rtmp_h265.git\ncd ffmpeg_rtmp_h265\ncp flv.h ~/FFmpeg/libavformat/\ncp flv*.c ~/FFmpeg/libavformat/\n</code></pre>\n\n<h3 id=\"ffmpeg_1\">ffmpeg \u91cd\u65b0\u7f16\u8bd1\u5b89\u88c5</h3>\n<pre class=\"codehilite\"><code>git clone https://github.com/FFmpeg/FFmpeg.git\ncd FFmpeg\ngit checkout n6.0\nmkdir build\n./configure \\\n  --prefix=$(pwd)/build \\\n  --enable-gpl --enable-nonfree --enable-pthreads --extra-libs=-lpthread \\\n  --disable-asm --disable-x86asm --disable-inline-asm \\\n  --enable-decoder=aac --enable-decoder=aac_fixed --enable-decoder=aac_latm --enable-encoder=aac \\\n  --enable-libx264 --enable-libx265 \\\n  --pkg-config-flags='--static'\nmake -j10\nmake install\n</code></pre>\n\n<h2 id=\"rtmpflv-h265\">rtmp/flv h.265 \u670d\u52a1\u5668\u652f\u6301</h2>\n<p>nginx-rtmp \u53ea\u652f\u6301 h.264, SRS \u5df2\u652f\u6301 rtmp/flv h.265, \u56e0\u6b64\u5efa\u8bae\u4f7f\u7528 SRS \u670d\u52a1.</p>\n<pre class=\"codehilite\"><code>git clone https://github.com/ossrs/srs.git\ncd trunk\n./configure --osx --h265=on\nmake\n</code></pre>\n\n<p>SRS \u76f8\u5173\u64cd\u4f5c\u6307\u4ee4</p>\n<pre class=\"codehilite\"><code># \u542f\u52a8\n./objs/srs -c conf/rtmp.conf\n\n# \u67e5\u770b\u65e5\u5fd7\ntail -n 30 -f ./objs/srs.log\n\n# \u67e5\u770b\u670d\u52a1\u5668\u72b6\u6001\n./etc/init.d/srs status\n</code></pre>\n\n<p>\u5177\u4f53\u8be6\u7ec6\u89c1\u6587\u6863<a href=\"https://ossrs.net/lts/zh-cn/docs/v5/doc/getting-started-build\">SRS</a></p>"}