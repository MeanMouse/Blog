{"title": "Git \u4ed3\u5e93\u642d\u5efa", "date": "2018-11-28 15:29:59", "categories": "\u670d\u52a1\u5668", "tags": "Git\u4ed3\u5e93\u642d\u5efa", "keywords": "Git \u4ed3\u5e93\u642d\u5efa,Git,\u670d\u52a1\u5668", "description": "", "file_name": "Git-\u4ed3\u5e93\u642d\u5efa", "short": " \u521b\u5efagit\u65b0\u7528\u6237\u7ba1\u7406git\u4ed3\u5e93 \n ", "content": "<h4 id=\"gitgit\">\u521b\u5efagit\u65b0\u7528\u6237\u7ba1\u7406git\u4ed3\u5e93</h4>\n<!-- more -->\n\n<ol>\n<li>\u521b\u5efagit\u7528\u6237\u5e76\u914d\u7f6e</li>\n</ol>\n<pre><code># adduser git  // \u521b\u5efagit\u7528\u6237\n# passwd git  // \u8bbe\u7f6egit\u7528\u6237\u7684\u5bc6\u7801\n# chmod -v u+w /etc/sudoers  // \u8d4b\u4e88\u8bfb\u5199\u6743\u9650\n// \u6dfb\u52a0\u65b0\u7528\u6237\u4fe1\u606f\u81f3/etc/sudoers\n# vim /etc/sudoers\n\n// \u6dfb\u52a0\u65b0\u7528\u6237\u4fe1\u606f\u5982\u4e0b\n// Allow root to run any commands anywhere \nroot ALL=(ALL) ALL\ngit ALL=(ALL) ALL\n</code></pre>\n<ol start=\"2\">\n<li>\u751f\u6210\u5bc6\u94a5\uff08\u5728\u7535\u8111\u7684shell\u4e2d\u6267\u884c\uff09</li>\n</ol>\n<pre><code>$ ssh-keygen -t rsa  // \u4e00\u76f4\u56de\u8f66\u4f1a\u51fa\u73b0 key\u2019s randomart image\n$ pbcopy &lt; ~/.ssh/id_rsa.pub // \u590d\u5236id_rsa.pub\u4e2d\u7684\u5bc6\u94a5\n</code></pre>\n<ol start=\"3\">\n<li>\u5bc6\u94a5\u914d\u7f6e\uff08\u5728\u670d\u52a1\u5668\u914d\u7f6e\uff09</li>\n</ol>\n<pre><code># su git  // \u5207\u6362\u81f3git\u7528\u6237\uff0c\u5982\u679c\u5f53\u524d\u662f\u4e0d\u5fc5\u6267\u884c\n# mkdir ~/.ssh // \u521b\u5efa.ssh\u6587\u4ef6\n# vim ~/.ssh/authorized_keys // \u5c06\u4e0a\u6b65\u9aa4\u83b7\u53d6\u7684\u5bc6\u94a5\u590d\u5236\u5230authorized_keys\u6587\u4ef6\u91cc\n\n# cd \uff5e // git\u7528\u6237\u4e0b\u7684\u6839\u76ee\u5f55\n// \u8bbe\u7f6e\u6743\u9650\n# chmod 600 .ssh/authorzied_keys\n# chmod 700 .ssh\n</code></pre>\n<ol start=\"4\">\n<li>\u6d4b\u8bd5\u662f\u5426\u80fd\u8fde\u63a5\u670d\u52a1\u5668</li>\n</ol>\n<pre><code>$ ssh -v git@SERVERIP // SERVERIP \u4e3a\u670d\u52a1\u5668\u516c\u7f51ip\n</code></pre>\n<ul>\n<li>\u5982\u679c\u4e0d\u7528\u8f93\u5165\u5bc6\u7801\u76f4\u63a5\u8fdb\u5165\uff1a\u80fd\u8fde\u63a5\u670d\u52a1\u5668\u5e76\u4e14rsa\u5bc6\u94a5\u914d\u7f6e\u6210\u529f</li>\n<li>\u5982\u679c\u9700\u8981\u8f93\u5165\u5bc6\u7801\u8fdb\u5165\uff1a\u672a\u914d\u7f6e\u5bc6\u94a5\u6216\u8005\u5bc6\u94a5\u65e0\u6548</li>\n<li>\u5982\u679c\u51fa\u73b0 Host key verifocation failed\uff1a\u68c0\u67e5\u672c\u5730\u5bc6\u94a5\u662f\u5426\u5b58\u5728 known_hosts\u6587\u4ef6\uff0c\u5b58\u5728\u7684\u8bdd\u5c06\u5176\u5220\u9664</li>\n<li>\u5176\u4ed6\u672a\u77e5\u7ed3\u679c\uff1a\u65e0\u6cd5\u8bbf\u95ee\u670d\u52a1\u5668</li>\n</ul>\n<ol start=\"5\">\n<li>\u5efa\u7acbgit\u7a7a\u5e93\uff0c\u4e5f\u53eb\u88f8\u5e93\uff0c\u53ea\u6709\u4e00\u4e2a.git\u6587\u4ef6\u3002\u5728git\u7528\u6237\u4e0b\u6267\u884c\uff0c\u56e0\u4e3a\u5728\u4e0a\u6b65\u9aa4\u914d\u7f6e\u7684\u6743\u9650\u53ea\u6709git\u7528\u6237\u62e5\u6709\u6240\u6709\u6743\u3002</li>\n</ol>\n<pre><code># cd /home/git  // \u8fdb\u5165git\u7528\u6237\u76ee\u5f55\u4e0b\n# git init --bare \u4ed3\u5e93\u540d\u79f0.git // \u521b\u5efagit\u4ed3\u5e93\n# chown git:git -R \u4ed3\u5e93\u540d\u79f0.git // \u914d\u7f6e\u65b0\u5efa\u7684git\u4ed3\u5e93\u7684\u6743\u9650\n</code></pre>\n<ol start=\"6\">\n<li>\u6d4b\u8bd5\u662f\u5426\u521b\u5efa\u6210\u529f</li>\n</ol>\n<pre><code>// clone git\u4ed3\u5e93\n$ git clone git@SERVERIP:/home/git/\u4ed3\u5e93\u540d\u79f0.git\n</code></pre>\n<h4 id=\"git-hooks\">\u4f7f\u7528 git-hooks \u540c\u6b65\u5230\u5176\u4ed6\u76ee\u5f55\u4e0b</h4>\n<p>\u5c06git\u4ed3\u5e93\u7684\u5185\u5bb9\u81ea\u52a8\u540c\u6b65\u81f3\u5176\u4ed6\u76ee\u5f55</p>\n<pre><code># vim \u4ed3\u5e93\u540d\u79f0.git/hooks/post-receive\n\n\u5728post-receive\u6587\u4ef6\u4e0b\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a\ngit --work-tree=\u76ee\u6807\u76ee\u5f55 --git-dir=git\u4ed3\u5e93\u5730\u5740 checkout -f\n\u5982\uff1agit --work-tree=/home/hexo --git-dir=/home/git/blog.git checkout -f\n</code></pre>\n<p>\u914d\u7f6epost-receive\u7684\u53ef\u6267\u884c\u6743\u9650</p>\n<pre><code># chmod +x /home/git/blog.git/hooks/post-receive\n</code></pre>"}